## shoppe package

# Basic information
name="mpv"
desc="Video player based on MPlayer/mplayer2"
version="0.29.1"
revision="1"
license="GPL 2.0 or later"
website="https://mpv.io"
makedepends="alsa-lib-dev cmocka-dev faac-dev ffmpeg-dev freetype-dev lame-dev libao-dev libass-dev libmad-dev libtheora-dev 
libva-dev libvdpau-dev libxext-dev libxinerama-dev libxkbcommon-dev libxrandr-dev libxscrnsaver-dev libxv-dev libxvmc-dev 
libxxf86dga-dev lua5.3-dev mesa-dev perl py-docutils python2 ttf-dejavu wayland-dev wayland-protocols x264-dev xvidcore-dev zlib-dev"
#optional=""
#makedepends=""
conflicts="mpv-git"
archdependent="true"

# Building/installation instructions
source="https://github.com/mpv-player/$name/archive/v$version.tar.gz"
sourcetype="targz"

shoppebuild() {
	cd "$tmpdir/$name"
	
	./bootstrap.py

	# Build
	./waf configure --prefix=/usr \
		--mandir=/usr/share/man \
		--confdir=/etc/mpv \
		--enable-alsa \
		--enable-libass \
		--enable-libmpv-shared \
		--enable-wayland \
		--enable-zsh-comp \
		--enable-test
	./waf build
}

shoppeinstall() {
	cd "$tmpdir/$name"
	# Package
	./waf install --destdir="$pkgdir"

	mkdir -p "$pkgdir"/usr/share/doc/$pkgname
	install -m644 "$builddir"/DOCS/*.rst "$builddir"/DOCS/*.md \
		"$pkgdir"/usr/share/doc/$pkgname/

	# Move example configuration files to subdirectory
	mkdir -p "$pkgdir"/usr/share/doc/mpv/examples
	mv "$pkgdir"/usr/share/doc/mpv/*.conf \
		"$pkgdir"/usr/share/doc/mpv/examples/
}
